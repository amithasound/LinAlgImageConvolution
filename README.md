# LinAlgImageConvolution

Amitha Soundararajan
Dr. Muller
MAT 2400
6 May 2023
Convolution and Image Processing
1. Introduction:
Linear Algebra has many real-life applications, one of them being convolution. Convolution is a mathematical operation on two functions (f and h) that produces a third function (g) which expresses how the shape of one is modified by the other. In this course, we examined 1D convolution for time series data analysis. But, the applications for convolution go on. Convolution is a crucial operation used in both signal and image processing. This operation can be used in 1D, 2D, or 3D for speech, image, or video processing respectively. For our purpose, we will focus on image processing. In imaging processing, convolution can be used for purposes like image sharpening, blurring, and edge detection which identifies curves and edges of images. 

1. Background on Image Storage in Computing:
Images are separated into small picture elements called pixels. For black and white images, each pixel has a value ranging from 0 - 255 indicating lighter shades closer to 255. Therefore, each black and white image is a 2D matrix with values from 0 - 255. Colored photos have 3 matrices, one for red, green, and blue with each pixel having a component for each color. 

2. Process of Convolution:								Convolution is used to process an image by applying a kernel, a small matrix that is used to apply image effects, over each pixel and its neighbors across the entire image. After placing the Kernel matrix over each pixel of the image, it multiplies each value of the kernel with the corresponding pixel it is over. Then sums the resulting multiplied values and returns the value as the new value of an output image pixel. This process is repeated across the entire image. In the example below, the input image is represented as f, the kernel is w of size, m n , and the output image is g.  W convolution f is represented by the equation below:
<img width="643" alt="image" src="https://github.com/amithasound/LinAlgImageConvolution/assets/70346133/5aafeaf7-5f5e-4f24-8704-e0b8798f0500">


As seen in Figure 1, the output image will be a matrix from the operation above. Figure 2 shows the center value, -4,  in the kernel is aligned with the first value in the input image, 1. Then convolution on the pixel and its neighbors is performed. To obtain the first value in the output image, the equation is (-4 * 1 ) + (1 * 0 )+(1 * 1 )+(0 * 1 ) = -3.  The center value then aligns with the pixel to the right and does the multiplication on it and its surrounding pixels. Once the kernel reaches the end of the input image, the output image is completed. Each value in the output image has been generated by performing convolution of kernel and pixels. The completed image’s matrix is seen in Figure 3. 
<img width="163" alt="image" src="https://github.com/amithasound/LinAlgImageConvolution/assets/70346133/1317cf08-1a2b-455d-a1c8-7ddce4f6577b">

3. Usage of Different Kernels:
The final output image depends on the kernel used for convolution. Each kernel has values that produce desired outputs. While the kernels seen above are 3x3 matrices, they can be of many sizes. Typically more complex kernels are larger. Kernels are generally odd-sized because all the previous layer pixels are symmetrical around the output pixel. Without symmetry, there will be distortion across layers. While even-size kernels are possible there might be distortion in the original output. Big convolution kernels are not cost-efficient. By using smaller matrices and therefore fewer parameters, the number of unrelated features is limited. Since smaller kernels are cost-efficient and odd size kernels are better, typically kernel sizes are at 3x3 or 5x5. Some popular 3x3 kernels used for edge detection, sharpening, and blurring are seen below represented:

<img width="586" alt="image" src="https://github.com/amithasound/LinAlgImageConvolution/assets/70346133/4c660d9a-95a0-4f1f-95a0-0dee498327e0">


The convolution is performed by the method below in Python: 
<img width="449" alt="image" src="https://github.com/amithasound/LinAlgImageConvolution/assets/70346133/b11e1a41-c3f3-45f8-b412-0dbe9b7c00be">

Figure 5.
Users can change the values of the kernel to see how the output changes. In Figure 4, it is shown that different kernel values can produce similar outputs. For instance, there are 2 matrices that are for sharpening and two that blur images above. The output for the second sharpening matrix is seen below: 
<img width="550" alt="image" src="https://github.com/amithasound/LinAlgImageConvolution/assets/70346133/96b3c87f-74b5-410e-ae1c-34ff704d4014">


Figure 6.
When this convolution is performed with the kernel ([[-1, -1, -1], [-1, 9, -1], [-1, -1, -1]]), the output matrix results in the image on the right. If convolution was performed with the kernel above and the input image in Figure 1, the first pixel of the output image would be (91) + (-1  0 ) + (-1  1) + (-1  1) = 7. In addition to the many kernels that alter images, there is also an identity kernel that does not change the image and illustrates the process of convolution well. When looking at Figure 1 and Figure 2, if the kernel was ([[0, 0, 0], [0, 1, 0], [0, 0, 0]]). It is seen clearly that only the center value of the kernel, 1, will multiply by each pixel and the output pixel will be identical to the input pixel producing the same image. 

4. Conclusion
2D Convolution has many real-world applications in image processing that are extremely useful. The process of convolution allows for many different applications of image processing like blurring, sharpening (deblurring), and edge detection. Furthermore, understanding the basics of 2D convolution translates into other image processing topics like image filtering which uses a collection of kernels to filter images. Overall, convolution is just one topic that shows the versatile uses of linear algebra in the world. 

Jupyter Notebook Github code: https://github.com/amithasound/LinAlgImageConvolution.git







Citations
(2021). YouTube. Retrieved May 9, 2023, from https://youtu.be/VEp00wlzQN0. Basavarajaiah, M. (2022, March 29). 6 basic things to know about convolution. Medium. https://medium.com/@bdhuma/6-basic-things-to-know-about-convolution-daef5e1bc411#:~:text=In%20image%20processing%2C%20convolution%20is,effect%20of%20the%20convolution%20process
Gonzalez, R. C., & Woods, R. E. (2018). Digital Image Processing (f). Pearson.
H.L, S. (2018, November 30). 2D convolution in image processing - technical articles. All About Circuits. https://www.allaboutcircuits.com/technical-articles/two-dimensional-convolution-in-image-processing/
Ihare, A. (2020, November 5). Significance of kernel size. Medium. https://medium.com/analytics-vidhya/significance-of-kernel-size-200d769aecb1
Introduction to applied linear algebra – vectors, matrices, and least squares. (n.d.). https://web.stanford.edu/~boyd/vmls/
Powell, V. (n.d.). Image kernels explained visually. Explained Visually. https://setosa.io/ev/image-kernels/
S, D. (2021, April 9). Visualizing convolution filters in Python (tutorial). YouTube. https://youtu.be/FbDWmT93nUs
Sahoo, S. (2022, September 26). Deciding optimal filter size for cnns. Medium. https://towardsdatascience.com/deciding-optimal-filter-size-for-cnns-d6f7b56f9363
Singh, H. (2021, March 18). How images are stored in the computer?. Analytics Vidhya. https://www.analyticsvidhya.com/blog/2021/03/grayscale-and-rgb-format-for-storing-images/ 






















Credits to youtube videos below: 
https://youtu.be/FbDWmT93nUs
https://youtu.be/m3cZJoK4qt8
